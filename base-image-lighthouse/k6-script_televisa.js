// Auto-generated by the postman-to-k6 converter

import "./libs/shim/core.js";
import "./libs/shim/expect.js";

export let options = { maxRedirects: 4 };

const Post = Symbol.for("post");
const Request = Symbol.for("request");
postman[Symbol.for("initial")]({
  options
});

export default function() {
  postman[Post].push(() => {
    const jsonData = pm.response.json();

    utils = {
      myFunc: function() {
        return "helloooooooo";
      },
      menuFooter: function() {
        jsonData.footer.menu_footer.forEach(e => {
          if (e.value == "Derechos de réplica") {
            pm.expect(e.link).to.be.eq("/derechos-de-replica");
          } else if (e.value == "Código de Ética") {
            pm.expect(e.link).to.be.eq("/codigo-de-etica");
          } else if (e.value == "Políticas de privacidad") {
            pm.expect(e.link).to.be.eq("/politicas-de-privacidad");
          }
        });
      },
      menuFooterVacio: function() {
        pm.expect(jsonData.footer.menu_footer).not.empty;
      },
      linksContactanos: function() {
        jsonData.footer.contact.forEach(e => {
          if (e.value == "contacto@televisa.news") {
            pm.expect(e.link).to.be.eq("mailto:contacto@televisa.news");
          } else if (
            e.value == "+55 5224 - 5000 | 55 5261 - 2000 | 55 5728 - 3999"
          ) {
            pm.expect(e.link).to.be.eq(
              "tel:+55 5224 - 5000 | 55 5261 - 2000 | 55 5728 - 3999"
            );
          }
        });
      },
      contactanosVacio: function() {
        pm.expect(jsonData.footer.contact).not.empty;
      },
      copyrightPresente: function() {
        pm.expect(jsonData.footer).to.have.property("copyright");
      },
      copyrightVacio: function() {
        pm.expect(jsonData.footer.copyright).not.equal("");
      },
      linksRedesSociales: function() {
        jsonData.footer.social_networks.forEach(e => {
          if (e.value === "Twitter") {
            pm.expect(e.link).to.be.eq("https://twitter.com/nmas");
          } else if (e.value === "Instagram") {
            pm.expect(e.link).to.be.eq("https://www.instagram.com/n.mas/");
          } else if (e.value === "Youtube") {
            pm.expect(e.link).to.be.eq(
              "https://www.youtube.com/channel/UCUsm-fannqOY02PNN67C0KA"
            );
          } else if (e.value === "Tik Tok") {
            pm.expect(e.link).to.be.eq("https://www.tiktok.com/@n.mas?lang=es");
          } else if (e.value === "Facebook") {
            pm.expect(e.link).to.be.eq("https://www.facebook.com/nmas.com.mx");
          }
        });
      },
      socialNetworksVacio: function() {
        pm.expect(jsonData.footer.social_networks).not.empty;
      },
      bloqueParrillaProgramacion: function(parrillaProgramacion) {
        parrillaProgramacion.forEach(e => {
          pm.expect(e).to.have.property("canal_name");
          pm.expect(e.canal_name).not.equal("");
          pm.expect(e).to.have.property("logo_canal");
          pm.expect(e.logo_canal).not.equal("");
          e.parrilla_canal.PROGRAMACION.CANAL.SHOWS.forEach(f => {
            pm.expect(f).to.have.property("title");
            pm.expect(f.title).not.equal("");
            pm.expect(f).to.have.property("description");
            pm.expect(f.description).not.equal("");
            pm.expect(f).to.have.property("duration");
            pm.expect(f.duration).not.equal("");
          });
        });
      },
      bloqueLinksMenuFooter: function(menuFooter) {
        pm.expect(menuFooter).not.empty;
      },
      bloqueDetalleVideo: function(detalleVideo) {
        pm.expect(detalleVideo).to.have.property("title");
        pm.expect(detalleVideo.title).not.equal("");
        pm.expect(detalleVideo).to.have.property("description");
        pm.expect(detalleVideo.description).not.equal("");
      },
      bloqueDetalleTalento: function(detalleTalento) {
        pm.expect(detalleTalento).to.have.property("name");
        pm.expect(detalleTalento.name).not.equal("");
        pm.expect(detalleTalento).to.have.property("last_name");
        pm.expect(detalleTalento.last_name).not.equal("");
        pm.expect(detalleTalento).to.have.property("description");
        pm.expect(detalleTalento.description).not.equal("");
        pm.expect(detalleTalento).to.have.property("photo");
        pm.expect(detalleTalento.photo).not.equal("");
      },
      bloqueListadoProgramas: function(listadoProgramas) {
        listadoProgramas.forEach(e => {
          pm.expect(e).to.have.property("title");
          pm.expect(e.title).not.equal("");
          pm.expect(e).to.have.property("cover");
          pm.expect(e.cover).not.equal("");
          pm.expect(e).to.have.property("channel");
          pm.expect(e.channel).not.equal("");
          pm.expect(e).to.have.property("endpoint");
          pm.expect(e.endpoint).not.equal("");
        });
      },
      bloqueSummaryVideos: function(videos) {
        videos.forEach(e => {
          pm.expect(e).to.have.property("title");
          pm.expect(e.title).not.equal("");
          pm.expect(e).to.have.property("description");
          pm.expect(e.description).not.equal("");
          pm.expect(e).to.have.property("endpoint");
          pm.expect(e.endpoint).not.equal("");
          pm.expect(e).to.have.property("canal");
          pm.expect(e.canal).not.equal("");
        });
      },
      bloqueListadoTalentos: function(listadoTalentos) {
        listadoTalentos.forEach(e => {
          pm.expect(e).to.have.property("name");
          pm.expect(e.name).not.equal("");
          pm.expect(e).to.have.property("last_name");
          pm.expect(e.last_name).not.equal("");
          pm.expect(e).to.have.property("image_profile");
          pm.expect(e.image_profile).not.equal("");
          pm.expect(e).to.have.property("endpoint");
          pm.expect(e.endpoint).not.equal("");
        });
      },
      bloqueListadoEpisodios: function(listadoEpisodios) {
        listadoEpisodios.forEach(e => {
          pm.expect(e).to.have.property("title");
          pm.expect(e.title).not.equal("");
          pm.expect(e).to.have.property("episode");
          pm.expect(e.episode).not.equal("");
          pm.expect(e).to.have.property("url");
          pm.expect(e.url).not.equal("");
        });
      },
      bloqueBannerProgramas: function(bannerProgramas) {
        pm.expect(bannerProgramas).to.have.property("title");
        pm.expect(bannerProgramas.title).not.equal("");
        pm.expect(bannerProgramas).to.have.property("imagen");
        pm.expect(bannerProgramas.imagen).not.equal("");
        pm.expect(bannerProgramas).to.have.property("imagen_banner");
        pm.expect(bannerProgramas.imagen_banner).not.equal("");
        pm.expect(bannerProgramas).to.have.property("imagen_mobile");
        pm.expect(bannerProgramas.imagen_mobile).not.equal("");
        pm.expect(bannerProgramas).to.have.property("color");
        pm.expect(bannerProgramas.color).not.equal("");
      },
      bloqueDetalleProgramas: function(programas) {
        programas.forEach(e => {
          pm.expect(e).to.have.property("title");
          pm.expect(e.title).not.equal("");
          pm.expect(e).to.have.property("description");
          pm.expect(e.description).not.equal("");
          pm.expect(e).to.have.property("episode");
          pm.expect(e.episode).not.equal("");
          pm.expect(e).to.have.property("url");
          pm.expect(e.url).not.equal("");
          pm.expect(e).to.have.property("canal");
          pm.expect(e.canal).not.equal("");
          pm.expect(e.data_video).not.empty;
        });
      },
      bloqueTemasInteres: function(temasInteres) {
        temasInteres.forEach(f => {
          pm.expect(f).to.have.property("id");
          pm.expect(f.id).not.equal("");
          pm.expect(f).to.have.property("name");
          pm.expect(f.name).not.equal("");
          pm.expect(f).to.have.property("url");
          pm.expect(f.url).not.equal("");
        });
      },
      jsonValido: function() {
        pm.response.to.be.json; // además que sea un JSON válido
      },
      existeBody: function() {
        pm.response.to.be.withBody; // body tiene que exitir
      },
      validaStatus200: function() {
        pm.response.to.have.status(200);
      },
      validaErrorUrl: function() {
        pm.expect(jsonData.layout.one_column).not.equal(
          "Invalid parameter in url"
        );
      },
      mainMenuVacio: function() {
        pm.expect(jsonData.header.main_menu).not.empty;
      },
      validacionMetas: function() {
        jsonData.layout.one_column.meta_tags.forEach(e => {
          pm.expect(e.value).to.have.property("title");
          pm.expect(e.value.title).not.equal("");
          pm.expect(e.value).to.have.property("description");
          pm.expect(e.value.description).not.equal("");
          pm.expect(e.value).to.have.property("robots");
          pm.expect(e.value.robots).not.equal("");
          pm.expect(e.value).to.have.property("og_site_name");
          pm.expect(e.value.og_site_name).not.equal("");
          pm.expect(e.value).to.have.property("og_type");
          pm.expect(e.value.og_type).not.equal("");
          pm.expect(e.value).to.have.property("og_title");
          pm.expect(e.value.og_title).not.equal("");
          pm.expect(e.value).to.have.property("og_description");
          pm.expect(e.value.og_description).not.equal("");
          pm.expect(e.value).to.have.property("og_locale");
          pm.expect(e.value.og_locale).not.equal("");
          pm.expect(e.value).to.have.property("og_locale_alternative");
          pm.expect(e.value.og_locale_alternative).not.equal("");
          pm.expect(e.value).to.have.property("twitter_cards_description");
          pm.expect(e.value.twitter_cards_description).not.equal("");
          pm.expect(e.value).to.have.property("twitter_cards_site");
          pm.expect(e.value.twitter_cards_site).not.equal("");
          pm.expect(e.value).to.have.property("twitter_cards_title");
          pm.expect(e.value.twitter_cards_title).not.equal("");
          pm.expect(e.value).to.have.property("twitter_cards_creator");
          pm.expect(e.value.twitter_cards_creator).not.equal("");
        });
      }
    };
  });

  postman[Request]({
    name: "Home",
    id: "e3ad81aa-3d72-4be5-b548-53b21ee5c85e",
    method: "GET",
    address: "https://admin.nmas.com.mx/api/v1/page?path=/",
    post(response) {
      const jsonData = pm.response.json();

      pm.test("Status code 200", function() {
        utils.validaStatus200();
      });

      pm.test("Validación que exista body", function() {
        utils.existeBody();
      });

      pm.test(
        "Validación que la respuesta contenga un Json válido",
        function() {
          utils.jsonValido();
        }
      );

      pm.test("Valida propiedad header logo alt", function() {
        pm.expect(jsonData.header.logo).to.have.property("alt");
      });

      pm.test("Valida header logo alt no este vacío", function() {
        pm.expect(jsonData.header.logo.alt).not.equal("");
      });

      pm.test("Valida propiedad header logo url", function() {
        pm.expect(jsonData.header.logo).to.have.property("url");
      });

      pm.test("Valida header logo url no este vacío", function() {
        pm.expect(jsonData.header.logo.url).not.equal("");
      });

      pm.test("Valida header main_menu no este vacío", function() {
        utils.mainMenuVacio();
      });

      pm.test("Valida social_network no este vacío", function() {
        utils.socialNetworksVacio();
      });

      pm.test("Validación links redes sociales", function() {
        utils.linksRedesSociales();
      });

      pm.test("Valida contact no este vacío", function() {
        utils.contactanosVacio();
      });

      pm.test("Validación links contáctanos", function() {
        utils.linksContactanos();
      });

      pm.test("Valida menu_footer no este vacío", function() {
        utils.menuFooterVacio();
      });

      pm.test("Validación links menu footer", function() {
        utils.menuFooter();
      });

      pm.test("Valida propiedad copyright este presente", function() {
        utils.copyrightPresente();
      });

      pm.test("Valida copyright no este vacío", function() {
        utils.copyrightVacio();
      });

      pm.test("Valida metas", function() {
        utils.validacionMetas();
      });
    }
  });

  postman[Request]({
    name: "programas",
    id: "e30e927e-9c7d-459a-9914-f3a7329719a3",
    method: "GET",
    address: "https://admin.nmas.com.mx/api/v1/page?path=/programas",
    post(response) {
      const jsonData = pm.response.json();

      pm.test("Status code 200", function() {
        pm.response.to.have.status(400);
      });

      pm.test("Validación error en URL", function() {
        pm.expect(jsonData.layout.one_column).to.be.eq(
          "Invalid parameter in url"
        );
      });
    }
  });

  postman[Request]({
    name: "programas/entodocaso",
    id: "95e9876f-a33b-4267-a921-f4bc018c5fd4",
    method: "GET",
    address: "https://admin.nmas.com.mx/api/v1/page{{queryParams}}",
    pre() {
      var path = pm.environment.get("path");
      if (!path || path.length == 0) {
        path = [
          "?path=/noticieros/programas/en-punto-denise-maerker",
          "?path=/noticieros/programas/despierta",
          "?path=/",
          "?path=/talentos/rene-delgado-delgado",
          "?path=/detalle-buscador",
          "?path=/nmas-media/programas/en-todo-caso-fernanda-caso/episodios/entre-industria-los-usuarios-como-entender-crisis-agua-monterrey",
          "?path=/noticieros/programas/despierta/videos/cuerpos-bucha-ucrania-estuvieron-calles-durante-semanas-nyt",
          "?path=/foro-tv/programas/es-hora-opinar",
          "?path=/foro-tv/programas/hora-21",
          "?path=/nmas-media/programas/bien-de-buenas-paola-becerra-jesus-bahena",
          "?path=/nmas-media/programas/en-todo-caso-fernanda-caso",
          "?path=/noticieros/programas/tercer-grado",
          "?path=/noticieros/programas/al-aire",
          "?path=/foro-tv/programas/estrictamente-personal",
          "?path=/foro-tv/programas/expreso-de-manana",
          "?path=/nmas-media/programas/punto-contrapunto-mariana-hernandez"
        ];
      }

      var currentPath = path.shift();
      pm.environment.set("queryParams", currentPath);
      pm.environment.set("path", path);
    },
    post(response) {
      var path = pm.environment.get("path");
      if (path && path.length > 0) {
        postman.setNextRequest("programas/entodocaso");
      } else {
        postman.setNextRequest(null);
      }

      const jsonData = pm.response.json();

      //pruebas de comportamiento
      pm.test(
        "Status code 200" + pm.environment.get("queryParams"),
        function() {
          utils.validaStatus200();
        }
      );

      pm.test("Validación error en URL", function() {
        utils.validaErrorUrl();
      });

      pm.test("Validación que exista body", function() {
        utils.existeBody();
      });

      pm.test(
        "Validación que la respuesta contenga un Json válido",
        function() {
          utils.jsonValido();
        }
      );

      pm.test.skip("checks vulnerability with trusted null origin", function() {
        pm.expect(
          pm.response.headers.get("Access-Control-Allow-Origin")
        ).not.equal("null");
        pm.expect(
          pm.response.headers.get("Access-Control-Allow-Credentials")
        ).to.be.oneOf([undefined, "false"]);
      });

      pm.test("Valida social_network no este vacío", function() {
        utils.socialNetworksVacio();
      });

      pm.test("Validación links redes sociales", function() {
        utils.linksRedesSociales();
      });

      pm.test("Valida contact no este vacío", function() {
        utils.contactanosVacio();
      });

      pm.test("Validación links contáctanos", function() {
        utils.linksContactanos();
      });

      pm.test("Valida menu_footer no este vacío", function() {
        utils.menuFooterVacio();
      });

      pm.test("Validación links menu footer", function() {
        utils.menuFooter();
      });

      pm.test("Valida propiedad copyright este presente", function() {
        utils.copyrightPresente();
      });

      pm.test("Valida copyright no este vacío", function() {
        utils.copyrightVacio();
      });

      pm.test("Validación block_custom", function() {
        jsonData.layout.one_column.block_custom.forEach(f => {
          if (f.bundle === "bloque_temas_de_interes") {
            utils.bloqueTemasInteres(f.fields.data.rows);
          } else if (
            f.bundle === "bloque_detalle_programs" ||
            f.bundle === "bloque_detalle_episodio"
          ) {
            utils.bloqueDetalleProgramasEpisodios(f.fields.episodes.rows);
          } else if (f.bundle === "bloque_listado_episodios_programs") {
            utils.bloqueListadoEpisodios(f.fields.episodes.rows);
          } else if (f.bundle === "bloque_banner_programs") {
            utils.bloqueBannerProgramas(f.fields);
          } else if (f.bundle === "bloque_listado_talentos") {
            utils.bloqueListadoTalentos(f.fields.talentos);
          } else if (f.bundle === "bloque_parrilla_de_programacion") {
            utils.bloqueParrillaProgramacion(f.fields.parrillas);
          } else if (
            f.bundle === "block_summary_videos" ||
            f.bundle === "block_programs_videos"
          ) {
            utils.bloqueSummaryVideos(f.fields.videos);
          } else if (f.bundle === "bloque_listado_de_programas") {
            utils.bloqueListadoProgramas(f.fields.programs);
          } else if (f.bundle === "bloque_detail_talent") {
            utils.bloqueDetalleTalento(f);
          } else if (f.bundle === "bloque_detail_video") {
            utils.bloqueDetalleVideo(f);
          } else if (
            f.bundle === "bloque_derechos_de_replica" ||
            f.bundle === "bloque_detalle_buscador" ||
            f.bundle === "bloque_codigo_de_etica" ||
            f.bundle === "bloque_politicas_de_privacidad"
          ) {
            utils.bloqueLinksMenuFooter(f.fields.meta_tags);
          }
        });
      });
    }
  });

  postman[Post].pop();
}
